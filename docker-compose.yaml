services:
  cloudflare-dns-updater:
    image: ghcr.io/artemis-mike/cloudflare-dns-updater:latest
    restart: unless-stopped
    environment:
      CF_UPDATER_ZONE_ID:   ${CF_UPDATER_ZONE_ID}
      CF_UPDATER_A_RECORD:  ${CF_UPDATER_A_RECORD}
      CF_UPDATER_TOKEN:     ${CF_UPDATER_TOKEN}
    healthcheck:
      test:
        - CMD
        - if [ "$(expr $(date +%s) - $(cat lastRun.epoch))" -lt "$(expr $CF_UPDATER_INTERVAL \* 2)" ]; then exit 0; else exit 1; fi
      interval: 5m
      timeout: 10s
      retries: 3      